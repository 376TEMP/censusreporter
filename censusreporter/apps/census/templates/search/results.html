{% extends '_base.html' %}

{% block content_container %}
<div class="content-container clearfix">

<article id="full-text" class="clearfix wrapper">
    <section class="column-full clearfix big-action">
        <div class="input-wrapper with-submit">
            <form action="http://127.0.0.1:8000/search-results">
                <input name="q" id="search" type="text" autocomplete="off">
                <input type="submit" value="Search">
            </form>
        </div>
    </section>

    <div class="row">
        <div class="col-md-2">
            <div>
                <h3>Filter by</h3>
                <br>
                <ul>
                {% if contains.profile %}
                    <li><a id="filter-profile" href="#">Profiles</a>
                        <ul id="sumlevel_names-list">
                        {% for name, count in sumlevel_names.items %}
                            <li><a class="filter-sumlevel_names" href="#">{{ name }} ({{ count }})</a></li>
                        {% endfor %}
                        </ul>
                    </li>
                {% endif %}
                {% if contains.table %}
                    <li><a id="filter-table" href="#">Tables</a>
                        <ul id="topics-list">
                        {% for topic, count in topics.items %}
                            <li><a class="filter-topics" href="#">{{ topic }} ({{ count }})</a></li>
                        {% endfor %}
                        </ul>
                    </li>
                {% endif %}
                </ul>
            </div>
        </div>

        <div class="col-md-10">
            <ul id="filter-tabs" class="nav nav-tabs">
                <li class="active" id="tab-all" role="presentation"><a data-toggle="tab" href="#all">All</a></li>

                {% if contains.profile %}
                    <li role="presentation" id="tab-profiles"><a data-toggle="tab" href="#profiles">Profiles</a></li>
                {% endif %}

                {% if contains.table %}
                    <li role="presentation" id="tab-tables"><a data-toggle="tab" href="#tables">Tables</a></li>
                {% endif %}
            </ul>

            <div class="tab-content content-container">
                <div id="all" class="tab-pane active">
                {% for item in results %}
                    <div>
                    {% if item.type == "profile" %}
                        <h3><a href="{{ item.url }}">{{ item.full_name }}</a></h3>
                        <p>{{ item.sumlevel_name }}</p>
                    {% elif item.type == "table" %}
                        <h3><a href="{{ item.url }}">Table {{ item.table_id }}: {{ item.simple_table_name }}</a></h3>
                        <p>Topics: {{ item.topics }}<br>Subtables: {{ item.subtables }}</p>
                    {% endif %}
                    </div>
                {%  endfor %}
                </div>

                <div id="profiles" class="tab-pane">
                    {% for item in results %}
                        {% if item.type == "profile" %}
                            <div data-sumlevel_name="{{ item.sumlevel_name }}">
                                <h3><a href="{{ item.url }}">{{ item.full_name }}</a></h3>
                                <p>{{ item.sumlevel_name }}</p>
                            </div>
                        {% endif %}
                    {%  endfor %}
                </div>

                <div id="tables" class="tab-pane">
                    {% for item in results %}
                        {% if item.type == "table" %}
                            <div data-topic="{{ item.topics }}">
                                <h3><a href="{{ item.url }}">Table {{ item.table_id }}: {{ item.simple_table_name }}</a></h3>
                                <p>Topics: {{ item.topics }}<br>Subtables: {{ item.subtables }}</p>
                            </div>
                        {% endif %}
                    {%  endfor %}
                </div>
            </div>
        </div>
    </div>
</article>
</div>
{% endblock %}


{% block body_javascript_extra %}{{ block.super }}
    <script src="{{ STATIC_URL }}js/search-results.js"></script>
{% endblock %}